import matplotlib.pyplot as plt
import numpy as np
from saxs_single_bead.scattering_curve import scattering_curve

locations = [
    [1.067, 9.654, 8.994],
    [1.246, 1.2972000000000001e1, 7.197000000000001],
    [-2.285, 1.4327e1, 7.313],
    [-3.767, 1.6491e1, 4.63],
    [-5.049, 1.9858e1, 5.883],
    [-8.777, 1.9141e1, 5.499],
    [-8.178, 1.5522e1, 6.535],
    [-6.778, 1.6716e1, 9.847],
    [-9.522, 1.9337e1, 1.0243e1],
    [-1.2200000000000001e1, 1.664e1, 9.937],
    [-1.0458e1, 1.4389e1, 1.2465e1],
    [-1.0053e1, 1.7189e1, 1.4978e1],
    [-1.3705e1, 1.8186e1, 1.4557e1],
    [-1.4889e1, 1.4602e1, 1.4941000000000003e1],
    [-1.2914e1, 1.4403e1, 1.8184e1],
    [-1.4489e1, 1.7587e1, 1.9538e1],
    [-1.175e1, 2.0183e1, 1.9211e1],
    [-1.3802000000000001e1, 2.2728e1, 1.72e1],
    [-1.4573e1, 2.5444000000000003e1, 1.9745e1],
    [-1.2977e1, 2.3461e1, 2.259e1],
    [-1.2219e1, 2.5991e1, 2.5333e1],
    [-1.3517000000000001e1, 2.854e1, 2.2795e1],
    [-1.0841e1, 2.7843000000000004e1, 2.0178e1],
    [-1.2187000000000001e1, 2.747e1, 1.6639e1],
    [-1.1079e1, 2.4612e1, 1.4399e1],
    [-8.736, 2.6834000000000003e1, 1.2357e1],
    [-6.702000000000001, 2.7584000000000003e1, 1.5498e1],
    [-6.039, 2.387e1, 1.6062e1],
    [-5.22, 2.3174000000000003e1, 1.2403e1],
    [-2.893, 2.6198000000000004e1, 1.2355e1],
    [-1.143, 2.4998e1, 1.5541000000000002e1],
    [-0.693, 2.1528e1, 1.406e1],
    [0.725, 2.296e1, 1.0821e1],
    [3.432, 2.4902000000000005e1, 1.2635e1],
    [4.074, 2.2368e1, 1.5373e1],
    [4.39, 1.9254e1, 1.3204e1],
    [3.615, 2.0082e1, 9.549],
    [0.697, 1.7656e1, 1.0084e1],
    [3.057, 1.4703e1, 1.0693e1],
    [1.926, 1.2378e1, 1.3523e1],
    [5.483, 1.1044e1, 1.3837000000000002e1],
    [7.211, 1.4384e1, 1.4519000000000002e1],
    [9.476, 1.4479e1, 1.7574e1],
    [1.165e1, 1.7442e1, 1.8631e1],
    [1.4004e1, 1.769e1, 2.1624000000000002e1],
    [1.3691000000000003e1, 2.0783e1, 2.3795e1],
    [1.665e1, 2.2563e1, 2.5388e1],
    [1.5483e1, 2.1544e1, 2.8883e1],
    [1.5866e1, 1.7879e1, 2.7811e1],
    [1.2179000000000002e1, 1.7114e1, 2.7463e1],
    [1.084e1, 1.6154e1, 2.4027000000000005e1],
    [7.751, 1.723e1, 2.2092e1],
    [5.712, 1.4497e1, 2.0407e1],
    [3.196, 1.4149e1, 1.7611e1],
    [0.824, 1.6315e1, 1.5662e1],
    [0.511, 1.8878e1, 1.8464e1],
    [4.075, 1.8517e1, 1.986e1],
    [2.96, 1.7556e1, 2.3365000000000002e1],
    [5.821000000000001, 1.7864e1, 2.5841e1],
    [7.243000000000001, 1.5161e1, 2.8096e1],
    [8.065, 1.7598e1, 3.0938e1],
    [4.399, 1.7678e1, 3.1968000000000004e1],
    [2.1, 1.5607e1, 2.9826e1],
    [3.373, 1.2217e1, 2.8688e1],
    [6.002, 9.742, 2.9846e1],
    [9.083, 9.071, 2.7748e1],
    [1.1305e1, 7.739, 3.0551e1],
    [1.41e1, 1.0229e1, 2.9865000000000002e1],
    [1.2768000000000002e1, 1.3533e1, 3.1244000000000003e1],
    [1.3925e1, 1.3747e1, 3.4876e1],
    [1.1481e1, 1.543e1, 3.7208e1],
    [8.623, 1.4778e1, 3.4807e1],
    [4.945, 1.4519000000000002e1, 3.5239e1],
    [2.72, 1.2476e1, 3.2956e1],
    [-0.548, 1.4370000000000001e1, 3.3362e1],
    [-2.239, 1.2752e1, 3.0338e1],
    [-1.222, 9.373, 3.1716e1],
    [8.900000000000001e-2, 8.093, 2.8375e1],
    [3.432, 6.905, 2.7e1],
    [4.743, 9.688, 2.4698000000000004e1],
    [5.035, 7.1000000000000005, 2.1892e1],
    [1.202, 6.829, 2.1896e1],
    [1.114, 1.0441e1, 2.0672000000000004e1],
    [2.812, 9.395, 1.7404e1],
    [6.4e-2, 7.104, 1.6186e1],
    [-1.833, 7.518, 1.2925e1],
    [-5.023, 7.754, 1.5052000000000001e1],
    [-5.012, 1.1198e1, 1.6734e1],
    [-7.303, 1.0243e1, 1.9632e1],
    [-4.612, 1.03e1, 2.234e1],
    [-3.117, 1.357e1, 2.1141e1],
    [-6.555, 1.5213e1, 2.1108e1],
    [-7.508, 1.393e1, 2.4580000000000002e1],
    [-4.19, 1.5212000000000002e1, 2.5914e1],
    [-4.474, 1.8539e1, 2.4058000000000003e1],
    [-7.851, 1.9133e1, 2.5758e1],
    [-6.13, 1.8864e1, 2.9143e1],
    [-3.287, 2.1167e1, 2.8059e1],
    [-5.61, 2.3904e1, 2.6746e1],
    [-7.628, 2.3721e1, 2.9965e1],
    [-4.551, 2.4318e1, 3.2188e1],
    [-4.898, 2.8112e1, 3.2466e1],
    [-3.234, 2.98e1, 2.9526e1],
    [-5.381, 2.8411000000000005e1, 2.6724e1],
    [-3.564, 2.7832000000000004e1, 2.3461e1],
    [-0.581, 2.9976e1, 2.4546e1],
    [0.7540000000000001, 2.6643e1, 2.585e1],
    [1.7920000000000003, 2.6032e1, 2.2228e1],
    [4.517, 2.8629e1, 2.1575e1],
    [4.116, 2.8203e1, 1.7785e1],
    [0.3990000000000001, 2.8941e1, 1.8118e1],
    [1.124, 3.2137e1, 2.0051e1],
    [3.8370000000000006, 3.3266e1, 1.7655e1],
    [2.319, 3.2226e1, 1.4308e1],
    [-1.405, 3.1650000000000002e1, 1.4691000000000003e1],
    [-2.7320000000000007, 3.3872e1, 1.747e1],
    [-4.593, 3.6863e1, 1.6029e1],
    [-4.239, 3.5755e1, 1.2415000000000001e1],
    [-6.949, 3.4738e1, 9.956],
    [-7.079, 3.1124000000000002e1, 1.1243e1],
    [-1.0273e1, 3.0336e1, 9.315],
    [-8.027, 3.0196000000000005e1, 6.206],
    [-6.812, 2.6817e1, 7.556],
    [-1.0244000000000002e1, 2.5203e1, 7.081],
    [-1.0994000000000002e1, 2.6967e1, 3.7860000000000005],
    [-1.2389e1, 2.4617000000000004e1, 1.148],
    [-1.2893000000000002e1, 2.1753000000000004e1, 3.586],
    [-1.6165e1, 1.9845e1, 3.461],
    [-1.6464e1, 1.9472e1, 7.216],
]
sequence = list(
    "KVFGRCELAAAMKRHGLDNYRGYSLGNWVCAAKFESNFNTQATNRNTDGSTDYGILQINSRWWCNDGRTPGSRNLCNIPCSALLSSDITASVNCAKKIVSDGNGMNAWVAWRNRCKGTDVQAWIRGCRL"
)

experiment = np.array(
    [
        [
            1.4782259323193547e-2,
            1.7945820614573504e-2,
            2.20113994382925e-2,
            2.6213867207081742e-2,
            3.041722100563854e-2,
            3.4619860264060165e-2,
            3.88222137064278e-2,
            4.3024652893611626e-2,
            4.722652044868747e-2,
            5.142835942215784e-2,
            5.562988399796881e-2,
            5.983120850254192e-2,
            6.403201853821783e-2,
            6.82325713394451e-2,
            7.243318130388315e-2,
            7.663324821781858e-2,
            8.083297215248914e-2,
            8.503243885271111e-2,
            8.923170548169529e-2,
            9.34306577130199e-2,
            9.76293812915015e-2,
            0.10182807628837759,
            0.1058356460899254,
            0.10965183631985692,
            0.11346790079072461,
            0.11709349267958741,
            0.12052741378203219,
            0.12377046057212954,
            0.12701364709451995,
            0.13044725379930527,
            0.13388061597257778,
            0.137123715162285,
            0.14017537674383823,
            0.14322633093065779,
            0.14627799251221102,
            0.14932961479405688,
            0.15245694490562028,
            0.15505030290573413,
            0.15771951283449287,
            0.16058009362428322,
            0.16324861112962535,
            0.16591780234423764,
            0.16877776197408106,
            0.17163687542508116,
            0.1750687188035998,
            0.17724041634887427,
            0.17938787812184714,
            0.18212022958054158,
            0.1842159257788894,
            0.18726718301011952,
            0.18966685807879485,
            0.19228481944241277,
            0.19527105574436537,
            0.19755676166149722,
            0.2005431726288162,
            0.20289438055354897,
            0.20502889363434856,
            0.2086342732470175,
            0.20947596244191752,
            0.21242841908582294,
            0.21394871250245512,
            0.21694600067607023,
            0.22002416801807595,
            0.22364326742892365,
            0.22532064257008239,
            0.22562932867203306,
            0.22744843352949712,
            0.23026685678441233,
            0.23409370993247985,
            0.2347399081158446,
            0.23758507137521795,
            0.23816905137195382,
            0.2410796942500038,
            0.2421767348647766,
            0.24311376850710326,
            0.24417489204744663,
            0.2460989490192968,
            0.24653506479686832,
            0.2489260984980804,
            0.25050335223049464,
            0.252012925256304,
            0.25367293965813525,
            0.2544599533534067,
            0.25667982539874173,
            0.25816087989408515,
            0.25841770337519426,
            0.26187476254427394,
            0.2624046848936504,
            0.26587885040922904,
            0.26851746074222943,
            0.2704401181170964,
            0.2727680387024672,
            0.2711882743032055,
            0.2733237680052763,
            0.27518778980835085,
            0.2767628992220473,
            0.27501711379896804,
            0.2765396368643695,
            0.2790525649565863,
            0.2807609201762011,
            0.28151669154544495,
            0.28460809567351114,
            0.2866592882385682,
            0.2859071413269016,
            0.28917280465061884,
            0.2893551404578742,
            0.29167126871519017,
            0.2935827525129285,
            0.29639168233352625,
            0.29622960248014846,
            0.29781601376992656,
            0.2991231501102278,
            0.29987888042176863,
            0.3016226384510699,
            0.30405349677712185,
            0.3029465101039261,
            0.30829174259124564,
            0.3098750634949395,
            0.31157136462663,
            0.31325384274122753,
            0.3161041696224564,
            0.3157566053091228,
            0.32011390011073887,
            0.322237655897117,
            0.32626390370450925,
            0.3261101682508288,
            0.326437647472872,
            0.33031428639183386,
            0.3328688656863545,
            0.3329661043910212,
            0.33694707960419185,
            0.3357589482050874,
            0.34079493479929895,
            0.3402339931643846,
            0.34250257139569223,
            0.3450016517000914,
            0.346417346251699,
            0.3470979647847559,
            0.3492078459658137,
            0.3499856129673257,
        ],
        [
            1.7693746564334636,
            1.7508502442626654,
            1.7476051092006686,
            1.7356176980786975,
            1.7272630090034171,
            1.7159787053743538,
            1.7035225559237774,
            1.691417960219655,
            1.6769696728725065,
            1.6624042009432065,
            1.6465496986102421,
            1.6298749042022185,
            1.6110907873154714,
            1.5912520091893625,
            1.5716476002275561,
            1.5498166842048748,
            1.526579553196378,
            1.5022877609485192,
            1.4771756766256012,
            1.4507745618990187,
            1.423435970515226,
            1.3959801945492816,
            1.368643175153786,
            1.340381969547592,
            1.3116051517799323,
            1.2856228052085092,
            1.2575222917393576,
            1.2305691550617601,
            1.2041889207857914,
            1.1747993769129752,
            1.144407253837309,
            1.1176689555603223,
            1.0897685212683248,
            1.058967768568082,
            1.0310673342760845,
            1.0030057711836289,
            0.97185348696707,
            0.945865306572411,
            0.9173772106553282,
            0.8897775875524783,
            0.8584505556273248,
            0.8298857317100239,
            0.7997393528239343,
            0.7661236406799821,
            0.7295044591138864,
            0.6989189401931293,
            0.6734643624926702,
            0.6426125201727702,
            0.613914301819968,
            0.5843560312032574,
            0.5479998893274176,
            0.5183878916440177,
            0.4834878301282193,
            0.4500974013737853,
            0.4159134678600227,
            0.3898372511302839,
            0.36354183934665407,
            0.3134690646858691,
            0.3355670125799084,
            0.29279236263977304,
            0.25613891150196144,
            0.21430271997449823,
            0.17316202794001634,
            0.1454409042813738,
            0.11837276293613219,
            7.776568524020755e-2,
            0.11676545730190457,
            8.956597495549934e-2,
            5.1641602861208336e-2,
            7.324666802541002e-2,
            -1.7564829788045966e-2,
            2.555698458057054e-2,
            -5.803209579754243e-2,
            -1.3139005881455113e-3,
            -7.813625412981584e-2,
            4.0317151230140125e-2,
            1.3256955911458146e-2,
            -2.737649001673681e-2,
            -6.098042030993889e-2,
            -3.2900404493318325e-2,
            -7.867492211963989e-2,
            -6.496037221918916e-2,
            -2.2893216821552986e-2,
            -0.10227907496722888,
            -7.588865841332226e-2,
            -3.0567888258004272e-2,
            -9.442433809351791e-2,
            -0.14231686832982837,
            -0.10338179512694867,
            -0.1593617264763758,
            -0.11378706368428992,
            -0.13084376414267607,
            -0.18127493030204023,
            -4.680338339098733e-2,
            -8.48881534645225e-2,
            -0.11382950946220327,
            -0.15767414600080243,
            -0.18518603718535398,
            -7.069760550769355e-2,
            -0.12002972183347738,
            -0.15629533759883407,
            -0.11921783836465027,
            -0.14533310631954044,
            -0.18128855420061574,
            -0.11551390303642672,
            -0.15166915070568288,
            -6.032798470553247e-2,
            -0.11281379196888452,
            -0.10400057057992762,
            -0.18072892636682947,
            -0.14223211196080654,
            -7.31645042854383e-2,
            -0.10959845663309165,
            -0.17052546472767705,
            -0.10515465327394025,
            -7.202967844806607e-2,
            -0.10107408809373708,
            -0.1405588614175135,
            -9.003044158216489e-2,
            -0.13349696599060867,
            -9.117589170779117e-2,
            -6.068718403143181e-2,
            -9.099380841026927e-2,
            -7.498264406876864e-2,
            -8.602692084138241e-2,
            -0.12854323786920907,
            -0.1574095279707819,
            -7.613676574352923e-2,
            -0.10041963738145498,
            -3.7626115712215746e-2,
            -7.60344402770119e-2,
            -0.11902389430848914,
            -7.243579584026283e-2,
            -2.1100326740358444e-2,
            -0.12471426737442193,
            -6.700176574907268e-2,
            -1.0022525210330091e-2,
            -9.317075020377508e-2,
            -6.37105394457913e-2,
            -9.79406291114393e-3,
        ],
    ]
)

(qs, Is) = scattering_curve(sequence, np.array(locations))

plt.plot(qs, np.log10(Is))
plt.plot(experiment[0],experiment[1])
plt.show()
